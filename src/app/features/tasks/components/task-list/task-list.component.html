<div class="tasks-container">
  <!-- Header con acciones principales -->
  <div class="tasks-header">
    <div class="header-left">
      <h1>{{ taskTexts.title }}</h1>
    </div>
    <div class="header-actions">
      <button mat-flat-button color="primary" routerLink="new">
        <mat-icon>add</mat-icon>
        {{ taskTexts.newTaskButton }}
      </button>
      <button mat-stroked-button color="primary" routerLink="/dashboard">
        <mat-icon>dashboard</mat-icon>
        {{ taskTexts.dashboardButton }}
      </button>
      <app-user-menu></app-user-menu>
    </div>
  </div>

  <!-- Campo de bÃºsqueda -->
  <mat-card class="search-card">
    <mat-form-field appearance="outline" class="search-field">
      <mat-label>{{ taskTexts.searchLabel }}</mat-label>
      <input matInput [value]="searchTerm" (input)="onSearch($event)" [placeholder]="taskTexts.searchPlaceholder">
      <mat-icon matPrefix>search</mat-icon>
      <button mat-icon-button matSuffix *ngIf="searchTerm" (click)="clearSearch()" type="button">
        <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>
  </mat-card>

  <!-- Filtros -->
  <mat-card class="filters-card">
    <form [formGroup]="filterForm" (ngSubmit)="filterTasks()" class="filters-form">
      <div class="filters-grid">
        <mat-form-field appearance="outline">
          <mat-label>{{ taskTexts.statusFilterLabel }}</mat-label>
          <mat-select formControlName="status">
            <mat-option value="">{{ taskTexts.allStatuses }}</mat-option>
            <mat-option *ngFor="let statusKey of statuses" [value]="statusKey">
              <mat-icon [style.color]="getStatusColor(asTaskStatus(statusKey))">
                {{ getStatusIcon(asTaskStatus(statusKey)) }}
              </mat-icon>
              {{ getStatusLabel(asTaskStatus(statusKey)) }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>{{ taskTexts.priorityFilterLabel }}</mat-label>
          <mat-select formControlName="priority">
            <mat-option value="">{{ taskTexts.allPriorities }}</mat-option>
            <mat-option *ngFor="let priorityKey of priorities" [value]="priorityKey">
              <mat-icon [style.color]="getPriorityColor(asTaskPriority(priorityKey))">
                {{ getPriorityIcon(asTaskPriority(priorityKey)) }}
              </mat-icon>
              {{ getPriorityLabel(asTaskPriority(priorityKey)) }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>{{ taskTexts.fromDateLabel }}</mat-label>
          <input matInput [matDatepicker]="fromPicker" formControlName="fromDate">
          <mat-datepicker-toggle matSuffix [for]="fromPicker"></mat-datepicker-toggle>
          <mat-datepicker #fromPicker></mat-datepicker>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>{{ taskTexts.toDateLabel }}</mat-label>
          <input matInput [matDatepicker]="toPicker" formControlName="toDate">
          <mat-datepicker-toggle matSuffix [for]="toPicker"></mat-datepicker-toggle>
          <mat-datepicker #toPicker></mat-datepicker>
        </mat-form-field>
      </div>

      <div class="filters-actions">
        <button mat-flat-button color="primary" type="submit">
          <mat-icon>filter_list</mat-icon>
          {{ taskTexts.applyFiltersButton }}
        </button>
        <button mat-stroked-button type="button" (click)="loadTasks()">
          <mat-icon>refresh</mat-icon>
          {{ taskTexts.clearFiltersButton }}
        </button>
      </div>
    </form>
  </mat-card>

  <!-- Lista de tareas -->
  <div class="tasks-grid">
    <mat-card *ngFor="let t of tasks" class="task-card" [ngClass]="getStatusClass(t.status)">
      <mat-card-header>
        <mat-card-title>{{ t.title }}</mat-card-title>
        <mat-card-subtitle>
          <span class="due-date">
            <mat-icon>event</mat-icon>
            {{ t.dueDate | date }}
          </span>
        </mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
        <div class="task-info">
          <div class="task-status">
            <mat-icon [style.color]="getStatusColor(t.status)">
              {{getStatusIcon(t.status)}}
            </mat-icon>
            {{ getStatusLabel(t.status) }}
          </div>
          <div class="task-priority" [style.color]="getPriorityColor(t.priority)">
            <mat-icon>{{ getPriorityIcon(t.priority) }}</mat-icon>
            {{ getPriorityLabel(t.priority) }}
          </div>
          <div class="task-assignee">
            <mat-icon>person</mat-icon>
            {{ t.userName }}
          </div>
        </div>
      </mat-card-content>

      <mat-card-actions align="end">
        <button mat-icon-button [routerLink]="['/tasks/edit', t.id]" color="primary">
          <mat-icon>edit</mat-icon>
        </button>
        <button mat-icon-button (click)="delete(t.id!)" color="warn">
          <mat-icon>delete</mat-icon>
        </button>
      </mat-card-actions>
    </mat-card>
  </div>
</div>
  